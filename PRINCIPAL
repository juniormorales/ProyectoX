#include <bits/stdc++.h>
#include <conio.h>
#include <windows.h>
using namespace std;
void gotoxy(int x,int y){  
       HANDLE hcon;  
       hcon = GetStdHandle(STD_OUTPUT_HANDLE);  
       COORD dwPos;  
       dwPos.X = x;  
       dwPos.Y= y;  
       SetConsoleCursorPosition(hcon,dwPos);  
}
void marco(){
	 	for(int j=1;j<110;j++){
 			gotoxy(j,0);
 			cout<<char(205);
 			gotoxy(j,27);
 			cout<<char(205);
 	}
 	gotoxy(110,0);cout<<char(187);
 	gotoxy(1,0);cout<<char(201);
 	gotoxy(1,27);cout<<char(200);
 	gotoxy(110,27);cout<<char(188);
 	
 	for(int k=0;k<26;k++){
 			gotoxy(1,k);
 			cout<<endl;
 			gotoxy(1,k+1);
 			cout<<char(186);
 			gotoxy(110,k+1);
 			cout<<char(186);
 	}
 	gotoxy(48,3);cout<<"PROYECTO X";
}
struct cuenta{
	string nombre;
	string apell;
	string usua;
	string contra;
	string pin;
	string correo;
	string cod;
};
struct app{
	string nom;
	string desar;
	string anyo;
	float precio,tam,puntaje;
};
cuenta usu[100];
void ingreso(cuenta []);
void crear(cuenta [],int &);
char menuprinc();
char menuusu();
void mainusuario(int );
char mainadmin(int );
void menuadmin();
void PERFIL(cuenta usu[],int ind);
void MODIFICANDOPERFIL(cuenta usu[],int ind,char num);
void OPCIONESPERFILMODIFICABLES(cuenta usu[],int ind);
int main(){
	usu[0]={"Franco","Mecca","francosmp","francosmp","9876","stha-182@hotmail.com","leonardo"};
	usu[1]={"Hector","Huapaya","hackerman","bitcoins","1234","hecdan89@hotmail.com","crack"};
	int v=1,usuCont=5;
	char o;
	while(v==1){
	marco();	
	o=menuprinc();
		switch(o){
			case '1': ingreso(usu); break;
			case '2': crear(usu,usuCont); break;
			case '3': v=0; break;		
		}
	}
}
char menuprinc(){
	char a;
	gotoxy(36,5);cout<<"-.-.-.-.-.-.BIENVENIDOS-.-.-.-.-.-"<<endl;
	gotoxy(36,8);cout<<"(1) INGRESAR"<<endl;
	gotoxy(36,11);cout<<"(2) CREAR USUARIO"<<endl;
	gotoxy(36,14);cout<<"(3) SALIR"<<endl;
	gotoxy(57,3);a=getch ();
	system("cls");
	return a;
}
void ingreso(cuenta usu[]){
	string u="",p="",n="";
	char resp;
	int i,t=0,ind;
	cout<<"INGRESE USUARIO Y CLAVE:"<<endl;
	cout<<"Usuario : ";
	cin>>u;
	cout<<"Password : ";
	cin>>p;
	cout<<"Pin : ";
	cin>>n;
	system("cls");
	for(i=0;i<100;i++){
		if(u==usu[i].usua && p==usu[i].contra && n==usu[i].pin && n!="g2e"){
			cout<<"Bienvenido, "<<u<<endl;
			t=1;
			ind=i;
			mainusuario(ind);
		}
		if(u==usu[i].usua && p==usu[i].contra && n=="g2e"){
			cout<<"Bienvenido, "<<u<<endl;
			t=1;
			ind=i;
		mainadmin(ind);
		}

	}
	while(t==0){
	cout<<"Usuario erroneo/no existe!"<<endl;
	cout<<"(1) Desea volver a intentar?"<<endl;
	cout<<"(2) Volver al menu principal"<<endl;
	resp=getch();
	system("cls");
		if(resp=='1'){
			cout<<"Ingrese sus datos nuevo!"<<endl;
		cout<<"Usuario:";
		cin>>u;
		cout<<"Password:";
		cin>>p;
		cout<<"Pin:";
		cin>>n;
			for(i=0;i<100;i++){
				if(u==usu[i].usua && p==usu[i].contra && n==usu[i].pin){
					cout<<"valido!";
					t=1;
				}
			}
		}
		else{
			t=1;
		}
}
	system("cls");
}
void mainusuario(int ind){
	char o;
	int v=1;
	while(v==1){
	o=menuusu();
		switch(o){
			case '1': PERFIL(usu,ind); break;
			case '2': //apps(usu,ind); break;
			case '3': //tienda(usu,ind); break;
			case '4': v=0; break;		
		}
	}
}
char menuusu(){
	char a,x,y,z;
	system("cls");
	cout<<"-.-.-.-.-.-.BIENVENIDO-.-.-.-.-.-"<<endl;
	cout<<"(1) Perfil"<<endl;
	cout<<"(2) Mis apps"<<endl;
	cout<<"(3) Tienda"<<endl;
	cout<<"(4) Cerrar sesion"<<endl;
	
	gotoxy(30,2);cin.clear(),cin>>a;
	return a;
	}
void crear(cuenta usu[],int &usuCont){
	string u;
	int i,j,t=0,a=0,f=0;
	cout<<"-.-.-.-.-.CREA TU CUENTA.-.-.-.-.-.-"<<endl;
	cout<<"Nombre : ";
	getline(cin,usu[usuCont].nombre);
	cout<<"Apellido : ";
	getline(cin,usu[usuCont].apell);
	cout<<"Usuario : ";
	getline(cin,usu[usuCont].usua);
	while(t==0){
		for(j=0;j<usuCont;j++){
			if(usu[usuCont].usua==usu[j].usua && usuCont!=j){
				cout<<"Nombre de usuario no disponible!"<<endl;
				cout<<"Usuario : ";
				getline(cin,usu[usuCont].usua);	
			}
			else t=1;
		}
	}	
	cout<<"Contraseña : ";
	getline(cin,usu[usuCont].contra);
	cout<<"Reingrese su Contraseña :  "<<endl;
	getline(cin,u);
	while(a==0){
		if(u!=usu[usuCont].contra){
			cout<<"Las contraseñas no son iguales"<<endl;
			cout<<"Reingrese su Contraseña : "<<endl;
			getline(cin,u);
			}
		else a=1;
	}
	cout<<"PIN : ";
	getline(cin,usu[usuCont].pin);
	cout<<"Correo : ";
	getline(cin,usu[usuCont].correo);
	while(f==0){
	for(i=0;i<100;i++){
		if(usu[usuCont].correo==usu[i].correo && usuCont!=i){
			cout<<"Ya existe una cuenta con este correo!"<<endl;
			cout<<"Correo : ";
			getline(cin,usu[usuCont].correo);	
		}
		else f=1;
	}
	}
	cout<<"Codigo de Seguridad (Este codigo servira para verificar las transacciones dentro de la empresa): "<<endl;
	getline(cin,usu[usuCont].cod);
	usuCont++;
	cout<<"Cuenta Creada Exitosamente!"<<endl;
	Sleep(2000);
	system("cls");
}
char mainadmin(int ind){
	char a;
	cout<<"-.-.-.-.-.-.BIENVENIDO-.-.-.-.-.-"<<endl;
	cout<<"(1) Administrar cuentas"<<endl;
	cout<<"(2) Tienda"<<endl;
	cout<<"(3) Cerrar sesion"<<endl;
	cin>>a;
	system("cls");
	return a;}
void menuadmin(int ind){
	char o;
	int v=1;
	while(v==1){
	o=mainadmin(ind);
	switch(o){
		case '1': //administrar(usu); break;
		case '2': //tienda(usu); break;
		case '3': v=0; break;
		default: mainadmin(ind);	
	}
	}
}
void PERFIL(cuenta usu[],int ind){ // int ind
	string codPermisos;
	char opc;
	system("cls");
	cin.ignore(256,'\n');
	cout<<"ingrese codigo de seguridad: ";
	getline(cin,codPermisos);
	if(codPermisos==usu[ind].cod){
		system("cls");
		cout<<"Nombre: "<<usu[ind].nombre<<endl;
		cout<<"Apellido: "<<usu[ind].apell<<endl;
		cout<<"Usuario: "<<usu[ind].usua<<endl;
		cout<<"Contraseña: "<<usu[ind].contra<<endl;
		cout<<"PIN: "<<usu[ind].pin<<endl;
		cout<<"Correo: "<<usu[ind].correo<<endl;
		cout<<"Codigo de Permisos: "<<usu[ind].cod<<endl;
		cout<<"-----------------------------------------"<<endl;
		cout<<"Para Modificar presione 'S', sino presione 'N' : ";opc=getch();
		if(opc=='s' or opc=='S')
			OPCIONESPERFILMODIFICABLES(usu,ind);
		else
			mainusuario(ind);
	}
	else{
		cout<<"Codigo Errado"<<endl,cout<<"Sera Redirigido"<<endl;
		Sleep(2000);
		mainusuario(ind);
	}	
}

void MODIFICANDOPERFIL(cuenta usu[],int ind,char num){	
	system("cls");
	switch(num){
		case '1': cout<<"Nuevo Nombre: ";cin>>usu[ind].nombre,mainusuario(ind);break;
		case '2': cout<<"Nuevo Apellido:";cin>>usu[ind].apell,mainusuario(ind);break;
		case '3': cout<<"Nuevo Usuario: ";cin>>usu[ind].usua,mainusuario(ind);break;
		case '4': cout<<"Nuevo Contraseña: ";cin>>usu[ind].contra,mainusuario(ind);break;
		case '5': cout<<"Nuevo PIN:";cin>>usu[ind].pin,mainusuario(ind);break;
		case '6': cout<<"Nuevo Correo:";cin>>usu[ind].correo,mainusuario(ind);break;
		case '7': cout<<"Nuevo Codigo de Permisos:";cin>>usu[ind].cod,mainusuario(ind);break;
		default : cout<<"Opcion Errada"<<endl,cout<<"Sera Redirigido"<<endl,Sleep(2000),mainusuario(ind);break;
	}
}

void OPCIONESPERFILMODIFICABLES(cuenta usu[],int ind){
	
	char num;	
	system("cls");
	cout<<"(1) Nombre"<<endl;
	cout<<"(2) Apellido"<<endl;
	cout<<"(3) Usuario"<<endl;
	cout<<"(4) Contraseña"<<endl;
	cout<<"(5) PIN"<<endl;
	cout<<"(6) Correo"<<endl;
	cout<<"(7) Codigo de Permisos"<<endl;
	cout<<"Ingrese el numero del dato a modificar : ";cin>>num;
	MODIFICANDOPERFIL(usu,ind,num);
}
